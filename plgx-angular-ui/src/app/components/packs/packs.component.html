
<div class="kt-grid kt-grid--hor kt-grid--root">
  <div class="kt-grid__item kt-grid__item--fluid kt-grid kt-grid--ver kt-page">
    <div class="kt-grid__item kt-grid__item--fluid kt-grid kt-grid--hor kt-wrapper" id="kt_wrapper">

<div class="kt-portlet kt-portlet--mobile kt-portlet--responsive-mobile no-mar-botom">
<div class="kt-portlet__head">
<div class="kt-portlet__head-label">
  <span class="kt-portlet__head-icon">
    <i class="kt-font-brand fa fa-sliders-h"></i>
  </span>
  <h3 class="kt-portlet__head-title txt-fmly">
     Packs
  </h3>
</div>
<div class="kt-portlet__head-toolbar ">
  <div class="kt-portlet__head-wrapper">
    <div class="">
      <button type="button" class="btn btn-outline-success btn-sm" data-toggle="modal" data-target="#add_pack" aria-haspopup="true" aria-expanded="false">
        <i class="fa fa-plus-square"></i>
        Add Pack
      </button>
      <!--Begin:: Modal-->
      <div class="modal fade" id="add_pack" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true" style="display: none; position: fixed; background-color: hsla(0, 0%, 0%, 0.45)">
        <!-- <form class="kt-form" id="kt_form" method="POST" enctype="multipart/form-data"> -->
          <form class="kt-form" id="kt_form" [formGroup]="packsfile">
          <div class="modal-dialog modal-lg" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h3 class="">Add New Pack File</h3>
              <button type="button" class="close" (click)="clearInput()" data-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <!--begin:: Widgets/Tasks -->

                <div class="row">
                  <div class="col-xl-2"></div>
                  <div class="col-xl-12">
                    <div class="kt-section kt-section--first">
                      <div class="kt-section__body">
                        <p>Learn how to format your query packs
                          <a target="_blank" href="https://osquery.readthedocs.org/en/stable/deployment/configuration/#query-packs" style="font-weight:500">here</a>.
                        </p>
                        <br>
                        <div class="form-group row">
                          <label class="col-3 col-form-label">Select a Category</label>
                          <div class="col-9">
                              <select class="kt-selectpicker form-control" id="category" formControlName="category" name="category" placeholder="Select a Category"  tabindex="-98">

                                <option value="Monitoring">Monitoring</option>
                                <option value="General">General</option>
                                <option value="Forensics and Incident Response">Forensics and Incident Response</option>
                                <option value="Compliance and Management">Compliance and Management</option>
                                <option value="Intrusion Detection">Intrusion Detection</option>
                                <option value="Others">Others</option>
                              </select>

                        </div>
                        </div>
                        <div class="form-group row">
                          <label class="col-3 col-form-label">Upload File</label>
                          <div class="custom-file col-9">
                            <input [(ngModel)]="clearValue" type="file" class="custom-input-file"  formControlName="pack" (change)="uploadFile($event)"  name="pack" id="pack">
                          </div>

                        </div>
                        <!-- <label class=""></label> -->
                      </div>
                    </div>

                  </div>
                  <div class="col-xl-2"></div>
                </div>

              <!--end:: Widgets/Tasks -->
            </div>
            <div class="modal-footer align-center">
              <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>
              <button type="submit" (click)="onSubmit()"  data-dismiss="modal"  class="btn btn-success active">Upload</button>
            </div>
          </div>
        </div>
        </form>
      </div>
      <!--End:: Modal-->
    </div>
  </div>
</div>
</div>
<div class="no_data" style="text-align: center;margin-top: 10px;"></div>

<div *ngIf="this.pack.data?.count!==0" class="kt-portlet__body txt-fmly">

<!--Begin:: Content -->
<div class="row">
  <div class="col-md-4">
  <!--begin::Portlet-->
  <div class="kt-portlet no-mar-botom portlet-body_align">
    <div class="kt-portlet__body txt-fmly" style="padding: 0px;">
      <!--begin: Search Table -->
      <div class="">
        <div class="kt-input-icon kt-input-icon--left" style="margin-bottom: 10px;">
          <input type="text" class="form-control" placeholder="Search Packs here..." id="search_pack_name" [(ngModel)]="searchText" >
          <span class="kt-input-icon__icon kt-input-icon__icon--left">
            <span><i class="la la-search"></i></span>
          </span>

        </div>
      </div>
      <!--end: Search Table -->
      <div class="placeholder_event" >
        <div class="ph-item" style="height: 575px;margin-bottom:25px;">
        <div class="ph-col-12">
        <div class="ph-row">
          <div class="ph-col-4 big"></div>
          <div class="ph-col-8 empty big"></div>
          <div class="ph-col-6 big"></div>
          <div class="ph-col-6 empty big"></div>
          <div class="ph-col-2 big"></div>
          <div class="ph-col-10 empty big"></div>
          <div class="ph-col-6 big"></div>
          <div class="ph-col-6 empty big"></div>
          </div>
          <div class="ph-row">
            <div class="ph-col-4 big"></div>
            <div class="ph-col-8 empty big"></div>
            <div class="ph-col-6 big"></div>
            <div class="ph-col-6 empty big"></div>
            <div class="ph-col-2 big"></div>
            <div class="ph-col-10 empty big"></div>
            <div class="ph-col-6 big"></div>
            <div class="ph-col-6 empty big"></div>
            </div>
            <div class="ph-row">
              <div class="ph-col-4 big"></div>
              <div class="ph-col-8 empty big"></div>
              <div class="ph-col-6 big"></div>
              <div class="ph-col-6 empty big"></div>
              <div class="ph-col-2 big"></div>
              <div class="ph-col-10 empty big"></div>
              <div class="ph-col-6 big"></div>
              <div class="ph-col-6 empty big"></div>
              </div>
              <div class="ph-row">
                <div class="ph-col-4 big"></div>
                <div class="ph-col-8 empty big"></div>
                </div>
            </div>
          </div>
      </div>
      <div class="show_packs_data" style="height: 575px; overflow-x: scroll;margin-bottom:25px;display: none;">
          <div *ngFor="let category_packs of packs_category_dictionary">
          

            <h3 style="color:#6371df">{{category_packs.category}}</h3>
            <!--begin::Notifications-->
            <div *ngFor="let packs of (category_packs.packs  | packsearch:searchText)" class="kt-notification conf-div" id="search_query-name-list" style="cursor:pointer;" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="{{packs}}">
                    <!-- <div *ngIf="packs === -1">No Matching Record Found</div> -->

                    <div *ngIf="packs != -1">

                    <div class="kt-notification__item-title list-group"  [ngClass]="{'active': selectedItem == packs}"   (click)='getById($event, packs,packs)' >
                    <a data-target="{{packs}}" class="kt-notification__item conf-link">
                      <!-- <div class="kt-notification__item-icon">
                     </div> -->
                     <div class="kt-notification__item-details txt-fmly">
                   
                         {{ packs}}
                     </div>
                   </a>


                  </div>
                  </div>
                  <div *ngIf="packs == -1">
                        <h4>No search results found</h4>
                  </div>
            </div>
          </div>
            <!--End::Notifications-->
      </div>
    </div>

  </div>
  </div>
  <div class="col-md-8 right-content-conf">
    <div class="right-conf kt-portlet no-mar-botom portlet-body_align__table" id="{{pack_data.name}}">
      <div class="placeholder_event" >
        <div class="kt-portlet__head ph-item" style="padding: 14px 15px 3px 13px;margin-bottom: 1px;">
          <div class="ph-col-12">
            <div class="ph-row">
              <div class="ph-col-6 big"></div>
             </div>
            </div>
        </div>
      </div>
      <div class="kt-portlet__head show_packs_data"  style="display: none;">
        <div class="kt-portlet__head-label">
          <span class="kt-portlet__head-icon">

          </span>
          <h3 class="kt-portlet__head-title">
            <!-- all-events-pack -->
            {{pack_data.name}}
          </h3>
        </div>
        <div class="kt-portlet__head-toolbar">
          <div class="kt-portlet__head-actions">
            <i style="font-size:12px;color: #fa0303;cursor: pointer;" (click) ="deletePacks(pack_data.id, pack_data.name)" title="Packs Disable" class="fa fa fa-trash-alt"></i>
          </div>

        </div>
      </div>
      <div class="kt-portlet__body" style="padding:10px;">

        <tag-input [theme]="'foundation-theme'" [placeholder]="'Add tags here...'" [(ngModel)]='pack_data.tags' (onAdd)="pack_addTag(pack_data.tags,pack_data.id)" (onRemove)="pack_removeTag($event,pack_data.id)" [modelAsStrings]="true"></tag-input>

      </div>
      <div class="placeholder_event" style="padding: 1.25rem;">
        <div class="ph-item">
        <div class="ph-col-12">
        <div class="ph-row">
          <div class="ph-col-4 big"></div>
          <div class="ph-col-8 empty big"></div>
          <div class="ph-col-6 big"></div>
          <div class="ph-col-6 empty big"></div>
          <div class="ph-col-2 big"></div>
          <div class="ph-col-10 empty big"></div>
          <div class="ph-col-6 big"></div>
          <div class="ph-col-6 empty big"></div>
          </div>
          <div class="ph-row">
            <div class="ph-col-4 big"></div>
            <div class="ph-col-8 empty big"></div>
            <div class="ph-col-6 big"></div>
            <div class="ph-col-6 empty big"></div>
            <div class="ph-col-2 big"></div>
            <div class="ph-col-10 empty big"></div>
            <div class="ph-col-6 big"></div>
            <div class="ph-col-6 empty big"></div>
            </div>
            <div class="ph-row">
              <div class="ph-col-4 big"></div>
              <div class="ph-col-8 empty big"></div>
              <div class="ph-col-6 big"></div>
              <div class="ph-col-6 empty big"></div>
              <div class="ph-col-2 big"></div>
              <div class="ph-col-10 empty big"></div>
              <div class="ph-col-6 big"></div>
              <div class="ph-col-6 empty big"></div>
              </div>
            </div>
          </div>
      </div>
      <div class="kt-portlet__body show_packs_data " style="height: 528px; overflow-x:scroll; padding:1.25rem; margin-bottom:20px;display: none;">
        <div class="accordion accordion-solid" id="accordion-{{pack_data.id}}">
          <!--begin::Portlet-->
<div *ngFor="let queries of pack_data.queries | keyvalue" class="kt-portlet__body" style="padding: 0px;">
<!--begin::Accordion-->
<div class="card right-conf-card " style="margin-bottom: 0.3rem;">
<div class="collapsed style-accordion-background" data-toggle="collapse" data-skin="dark" attr.data-target="#{{pack_data.name}}-query-{{queries.value.id}}" data-placement="top" title="{{ queries.value.name }}">
{{ queries.value.name}}
<a [routerLink] = "['./',queries.value.id,'edit']" class="query_edit" data-skin="dark" data-toggle="kt-tooltip" data-placement="top" title="Edit Packs">
<img class="pull-right" src="/assets/media/icons/edit-document.svg" height="24" width="24" alt="">
</a>
</div>

<div id="{{pack_data.name}}-query-{{queries.value.id}}" class="collapse" attr.data-parent="#accordion-{{pack_data.id}}">
<div class="card-body txt-fmly">
  <table class="table table-striped- table-bordered table-hover table-checkable">
    <tbody>
      <tr>
        <td class="head-table">Query</td>
        <td class="conf-table-val">
          <div>
            <div class="sql hljs">

            <span class="hljs-keyword desc-background_packs">{{queries.value.sql}}</span>
          </div>
        </div>
        </td>
      </tr>
      <tr>
        <td class="head-table">Interval</td>
        <td class="conf-table-val">
          <div class="desc-background_packs">{{queries.value.interval}}</div>

        </td>
      </tr>
      <tr>
        <td class="head-table">Platform</td>
        <td class="conf-table-val">

          <div class="desc-background_packs">{{ queries.value.platform}}
            <span class="col-md-1"></span>
            <button (click)="runAdHoc(queries.value.id)" class="btn-success"> Run Live </button>
          </div>
        </td>
      </tr>
      <tr>
        <td class="head-table">Description</td>
        <td class="conf-table-val">

          <div class="desc-background_packs truncate_packs">{{queries.value.description}}</div>
        </td>
      </tr>

      <tr>
        <td class="head-table">Version</td>
        <td>
        {{queries.value.version}}
        </td>

      </tr>
      <!-- {% endif %} -->
      <tr>
        <td class="head-table">Value</td>
        <td>
        {{queries.value.value}}
        </td>

      </tr>
      <!-- {% endif %} -->
      <tr>
        <td class="head-table">Packs</td>
        <td>
          <span class="label_pack"style="color:#6371df;font-size: 12px;font-weight: 700;cursor: pointer;word-break: break-word;" *ngFor="let pack_name of  queries.value.packs">
          <a href="packs#{{pack_name}}" >{{pack_name}}</a>&nbsp;
          </span>
          <!-- {% endfor %} -->
        </td>
      </tr>
      <tr>
        <td class="head-table">Tags</td>
        <td>
          <tag-input [theme]="'foundation-theme'"  [placeholder]="'Add tags here...'" [(ngModel)]='queries.value.tags' (onAdd)="queries_addTag(queries.value.tags,queries.value.id)" (onRemove)="queries_removeTag($event,queries.value.id)" [modelAsStrings]="true"></tag-input>
          <!-- <input class="tagsinput" placeholder="Add tags to schedule this query" value="{{ query.tags | map(attribute='value') | sort | join(',') }}" data-uri="{{ url_for('manage.tag_query', query_id=query.id) }}" size="23"> -->
        </td>
      </tr>

    </tbody>
  </table>
</div>

<!--end::Accordion-->
<!-- </div> -->
<!--end::Portlet-->

  </div>
</div>
<!--Begin:: Content -->
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
